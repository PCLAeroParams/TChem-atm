
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>UCI mechanism - E3SM Version 3 Chemistry - TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#uci-mechanism-e3sm-version-3-chemistry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms" class="md-header__button md-logo" aria-label="TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UCI mechanism - E3SM Version 3 Chemistry
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PCLAeroParams/TChem-atm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms" class="md-nav__button md-logo" aria-label="TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TChem-atm: a performance portable toolkit for atmospheric chemistry mechanisms
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PCLAeroParams/TChem-atm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../methodology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Methodology
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Input Files
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#troposphere-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      Troposphere Mechanism
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stratosphere-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      Stratosphere Mechanism
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="uci-mechanism-e3sm-version-3-chemistry"><strong>UCI mechanism - E3SM Version 3 Chemistry</strong></h1>
<p>E3SM version 3 uses the UCI mechanism to model gas chemistry employing separate reaction mechanisms for the Troposphere and Stratosphere. As part of the Sandia LDRD project "Benchmarking TChem for Potential Incorporation into E3SM as a Replacement Chemical Kinetics Solver", we created TChem-atm input files for the UCI mechanism. In addition, we implemented reaction types that are needed to solve this chemistry mechanism in TChem-atm.</p>
<p>E3SM currently employs the Community Atmospheric Model Pre-Processor (CAMPP) to generate a set of Fortran files that represent and solve the chemical kinetic model, which includes reaction coefficients, the right-hand side of volumetric mixing ratio (vmr, denoted <span class="arithmatex">\(\eta\)</span>), and ODE solvers (Implicit/Explicit solver). Ultimately, CAMPP aims to compute an updated vmr (<span class="arithmatex">\(\eta_{t+\Delta t}\)</span>) for the troposphere and stratosphere.</p>
<p>For additional information on this LDRD project, we recommend reading the <a href="/../sand_report/QTI_tchemV1.pdf">SAND2024-01807R report</a>. As described in the report, we employed TChem-atm to advance the system one-time step and compared these outputs with those from E3SM in six different locations (see table below).
To verify the performance and implementation of TChem-atm, we consider the relative root mean square error (RRMSE) of the difference between the E3SM and TChem-atm outputs.</p>
<table>
<thead>
<tr>
<th>Abbreviation</th>
<th>Latitude</th>
<th>Longitude</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>LA</td>
<td>34.0549</td>
<td>-118.2426</td>
<td>Los Angeles, CA, USA</td>
</tr>
<tr>
<td>BRW</td>
<td>71.323</td>
<td>-156.6114</td>
<td>North Slope, AK, USA</td>
</tr>
<tr>
<td>MHD</td>
<td>53.326</td>
<td>-9.899</td>
<td>Halfmace, County Galway, Ireland</td>
</tr>
<tr>
<td>PSA</td>
<td>-64.7742</td>
<td>-64.0527</td>
<td>Palmer Station, Antarctica</td>
</tr>
<tr>
<td>RPB</td>
<td>13.165</td>
<td>-59.432</td>
<td>Ragged Point, Barbados</td>
</tr>
<tr>
<td>SYO</td>
<td>-69.0125</td>
<td>39.59</td>
<td>Showa Station, Antarctica</td>
</tr>
<tr>
<td>ZEP</td>
<td>78.9067</td>
<td>11.8883</td>
<td>Zeppelin mountain, Ny-Ålesund, Norway</td>
</tr>
</tbody>
</table>
<h3 id="troposphere-mechanism"><strong>Troposphere Mechanism</strong></h3>
<p>The bash scripts and input files for UCI chemistry in the troposphere are located at <code>src/examples/runs/uci_col</code>. In this directory, we split the input file of TChem-atm into two files. One contains initial conditions, and the other file lists reactions, constant species, and active species. The chemistry file for the UCI mechanism is located at <code>src/examples/runs/uci_col/uci_v2_test3.yaml</code>. The initial conditions file for one of the UCI tests is located at <code>src/examples/runs/uci_col/input_conditions_col.yaml</code>, and corresponds to a set of cells for one location in an E3SM simulation.</p>
<p>Mechanism details:</p>
<ul>
<li>Number of species: 82</li>
<li>Number of invariants or constant species: 29</li>
<li>Number of reactions: 106</li>
<li>Number of Arrhenius-type reactions: 71</li>
<li>Number of JPL-Troe type reactions: 10</li>
<li>Number of Ratio JPL-Arrhenius type reactions : 3</li>
<li>Number of Photolysis rates: 22</li>
</ul>
<p>An example run script for the UCI mechanism is presented below:</p>
<div class="highlight"><pre><span></span><code><span class="nv">exec</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/TChem_AtmosphericChemistryE3SM.implicit_euler.x
<span class="nv">input</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/runs/atmospheric_chemistry/uci_col/uci_v2_test3.yaml
<span class="nv">inputFile</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/runs/atmospheric_chemistry/uci_col/input_conditions_multi_col.yaml

<span class="nv">run_this</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$exec</span><span class="s2"> --chemfile=</span><span class="nv">$input</span><span class="s2"> \</span>
<span class="s2">                --inputfile=</span><span class="nv">$inputFile</span><span class="s2"> \</span>
<span class="s2">                --outputfile=full_gas.dat \</span>
<span class="s2">                --time-iterations-per-interval=100 \</span>
<span class="s2">                --tol-time=1e-6 \</span>
<span class="s2">                --dtmin=1800 \</span>
<span class="s2">                --dtmax=1800 \</span>
<span class="s2">                --tend=1800 \</span>
<span class="s2">                --atol-newton=1e-18 \</span>
<span class="s2">                --rtol-newton=1e-8 \</span>
<span class="s2">                --max-newton-iterations=20 \</span>
<span class="s2">                --max-time-iterations=20000&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="nv">$run_this</span>
<span class="nb">eval</span><span class="w"> </span><span class="nv">$run_this</span>
</code></pre></div>
<p>For this configuration, TChem-atm is using an implicit Euler solver. The <code>inputfile</code> flag allows the user to pass the initial condition files as an independent file of the <code>chemfile</code> type. Furthermore, TChem-atm can be directed to run executables (<code>exec</code>) for the Tines-TrBDF2 solver, <code>TChem_AtmosphericChemistryE3SM.x</code> and for CVODE, <code>TChem_AtmosphericChemistryE3SM_CVODE.x</code>; however, note that the CVODE-TChem-atm executable works only on CPUs.</p>
<p><img alt="E3SM vs TChem-atm Troposhere" src="../figures/net_production_rate_worst.png" />
Parity plot for rate of progress in the troposphere. E3SM outputs are produced by CAMPP's generated code. There are 104 reactions, and we only display the 10 with the larges RRMSE for the locations given in the preceding table. RRMSE per location is presented in each plot. The net production rates correspond to the RHS of the equations solved by E3SM and TChem.</p>
<h3 id="stratosphere-mechanism"><strong>Stratosphere Mechanism</strong></h3>
<p>The UCI mechanism chemistry file for the stratosphere is located at <code>src/examples/runs/uci_col/uci_explicit_mech.yaml</code>. The initial conditions file for one of the UCI tests is located at <code>src/examples/runs/uci_col/input_conditions_explicit_part_multi_col.yaml</code>, which corresponds to one set of cells for one location in an E3SM simulation.</p>
<p>Mechanism details:</p>
<ul>
<li>Number of species: 7</li>
<li>Number of invariants or constant species invariants: 3</li>
<li>Number of reactions: 5</li>
<li>Number of Arrhenius-type reactions: 3</li>
<li>Number of JPL-Troe type reactions: 2</li>
</ul>
<p>E3SM uses an explicit Euler solver to time integrate gas chemistry in the Stratosphere. In TChem-atm, we also implemented an explicit Euler solver.</p>
<div class="highlight"><pre><span></span><code><span class="nv">exec</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/TChem_AtmosphericChemistryE3SM.explicit_euler.x
<span class="nv">input</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/runs/atmospheric_chemistry/uci_col/uci_explicit_mech.yaml
<span class="nv">inputFile</span><span class="o">=</span><span class="nv">$TCHEM_INSTALL_PATH</span>/examples/runs/atmospheric_chemistry/uci_col/input_conditions_explicit_part_multi_col.yaml

<span class="nv">run_this</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$exec</span><span class="s2"> --chemfile=</span><span class="nv">$input</span><span class="s2"> \</span>
<span class="s2">                --inputfile=</span><span class="nv">$inputFile</span><span class="s2"> \</span>
<span class="s2">                --outputfile=full_gas_stratosphere.dat \</span>
<span class="s2">                --time-iterations-per-interval=100 \</span>
<span class="s2">                --tol-time=1e-6 \</span>
<span class="s2">                --dtmin=1800 \</span>
<span class="s2">                --dtmax=1800 \</span>
<span class="s2">                --tend=1800 \</span>
<span class="s2">                --atol-newton=1e-18 \</span>
<span class="s2">                --rtol-newton=1e-8 \</span>
<span class="s2">                --max-newton-iterations=20 \</span>
<span class="s2">                --max-time-iterations=20000&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="nv">$run_this</span>
<span class="nb">eval</span><span class="w"> </span><span class="nv">$run_this</span>
</code></pre></div>
<p><img alt="E3SM vs TChem-atm Stratoshere" src="../figures/net_production_rates_stratosphere.png" /></p>
<p>Parity plot of the net production rates (RHS) in the stratosphere. RRMSE per location is presented in each plot. The net production rates correspond to the RHS of the equations solved by E3SM and TChem.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indices", "navigation.instant", "navigation.sections", "navigation.top"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>